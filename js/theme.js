function initTheme() { const hoverArea = document.createElement("div"); hoverArea.className = "theme-toggle-hover-area"; const themeToggle = document.createElement("button"); themeToggle.className = "theme-toggle"; themeToggle.setAttribute("aria-label", "切换深色模式"); hoverArea.appendChild(themeToggle); document.body.appendChild(hoverArea); const savedTheme = localStorage.getItem("theme") || "light"; document.documentElement.setAttribute("data-theme", savedTheme); themeToggle.addEventListener("click", () => { const currentTheme = document.documentElement.getAttribute("data-theme"); const newTheme = currentTheme === "dark" ? "light" : "dark"; document.documentElement.setAttribute("data-theme", newTheme); localStorage.setItem("theme", newTheme) }) } if (document.readyState === "loading") { document.addEventListener("DOMContentLoaded", initTheme) } else { initTheme() }